# 日志系统快速开始

## 🚀 5分钟上手

### 1. 确认环境变量

检查 `.env` 文件中的日志配置:

```bash
LOG_LEVEL=info          # 日志级别
LOG_DIR=logs            # 日志目录
NODE_ENV=development    # 运行环境
```

### 2. 启动服务

```bash
npm run start:dev
```

### 3. 查看日志

```bash
# 实时查看所有日志
tail -f logs/application-*.log

# 实时查看错误日志
tail -f logs/error-*.log

# 实时查看 HTTP 请求
tail -f logs/http-*.log
```

## 📋 日志文件说明

启动服务后,会自动在 `logs/` 目录生成以下文件:

```
logs/
├── application-2024-12-05.log      # 所有日志(info及以上)
├── error-2024-12-05.log            # 错误日志
├── http-2024-12-05.log             # HTTP请求日志
├── exceptions-2024-12-05.log       # 未捕获异常
└── rejections-2024-12-05.log       # Promise拒绝
```

## 🎯 常用命令

### 查看日志

```bash
# 查看今天的所有日志
tail -f logs/application-$(date +%Y-%m-%d).log

# 查看最近100行
tail -n 100 logs/application-*.log

# 搜索特定内容
grep "用户登录" logs/application-*.log

# 搜索错误
grep "ERROR" logs/application-*.log
```

### 日志分析

```bash
# 统计今天的错误数量
grep "ERROR" logs/application-$(date +%Y-%m-%d).log | wc -l

# 统计HTTP请求数量
grep "HTTP" logs/http-$(date +%Y-%m-%d).log | wc -l

# 查看最慢的10个请求
grep "HTTP" logs/http-*.log | sort -t'-' -k2 -nr | head -10
```

### 清理日志

```bash
# 删除7天前的日志
find logs/ -name "*.log" -mtime +7 -delete

# 删除压缩文件
rm logs/*.gz
```

## 📊 日志级别

- **error** - 系统错误、异常
- **warn** - 警告、敏感操作
- **info** - 重要业务操作
- **http** - HTTP请求(自动记录)
- **debug** - 调试信息、查询操作

## 🎨 日志示例

### 用户登录

```
[2024-12-05 06:00:15] DEBUG [AuthService] 登录尝试: admin
[2024-12-05 06:00:15] INFO  [AuthService] 用户登录成功: admin (ID: 1)
```

### 创建用户

```
[2024-12-05 06:01:20] INFO  [UserService] 创建用户: zhangsan
[2024-12-05 06:01:20] INFO  [UserService] 用户创建成功: zhangsan (ID: 100)
```

### HTTP请求

```
[2024-12-05 06:00:15] HTTP  GET /api/system/user/list 200 1234 - 45ms
[2024-12-05 06:00:16] HTTP  POST /api/system/user 201 567 - 120ms
```

### 错误

```
[2024-12-05 06:10:30] ERROR [AllExceptionsFilter] [GET] /api/system/user/999 - 用户不存在
```

## 🔧 调整日志级别

### 开发环境(查看详细日志)

```bash
# .env
LOG_LEVEL=debug
NODE_ENV=development
```

### 生产环境(只记录重要信息)

```bash
# .env
LOG_LEVEL=info
NODE_ENV=production
```

## 📚 更多文档

- **日志系统说明.md** - 完整使用文档
- **日志集成进度.md** - 集成进度
- **日志系统集成完成总结.md** - 完成总结

## 💡 提示

1. 日志文件每天自动轮转
2. 单个文件最大20MB
3. 自动保留14天
4. 旧文件自动压缩为.gz
5. 日志是异步写入,不影响性能

## 🎉 开始使用

现在启动服务,所有操作都会自动记录到日志文件中!

```bash
npm run start:dev
```

然后在另一个终端查看日志:

```bash
tail -f logs/application-*.log
```

尝试登录、创建用户等操作,你会看到实时的日志输出! 🚀

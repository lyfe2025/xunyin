# 前端组件问题修复汇总

> **更新时间:** 2025-12-09

本文档汇总了前端开发中遇到的组件使用问题及解决方案。

---

## 1. Checkbox 组件

### 问题
使用了错误的属性和事件名称，导致勾选状态不生效。

### 解决方案

| 用途 | ❌ 错误 | ✅ 正确 |
|------|---------|---------|
| 绑定值 | `:checked` | `:model-value` 或 `v-model` |
| 更新事件 | `@update:checked` | `@update:model-value` |

```vue
<!-- 正确用法 -->
<Checkbox 
  :model-value="checked"
  @update:model-value="(val) => checked = !!val"
/>

<!-- 或使用 v-model -->
<Checkbox v-model="checked" />
```

**注意:** `model-value` 类型是 `boolean | 'indeterminate'`，需用 `!!val` 转换为布尔值。

### 修复的文件
- `UserForm.vue` - 岗位/角色选择
- `role/index.vue` - 菜单权限树
- `code-generator.ts` - 代码生成模板

---

## 2. Switch 组件

### 问题
Switch 需要布尔值，但后端存储的是字符串 `'true'`/`'false'`，导致状态不同步。

### 解决方案
使用 computed 进行类型转换：

```typescript
const captchaEnabled = computed({
  get: () => form['sys.account.captchaEnabled'] === 'true',
  set: (val: boolean) => {
    form['sys.account.captchaEnabled'] = val ? 'true' : 'false'
  }
})
```

```vue
<Switch v-model:checked="captchaEnabled" />
```

### 修复的文件
- `system/config/index.vue` - 系统设置页面所有开关

---

## 3. 日期格式化

### 问题
日期显示为 ISO 格式 `2025-12-05T01:08:55.991Z`，不易读。

### 解决方案
使用统一的 `formatDate` 工具函数：

```typescript
import { formatDate } from '@/utils/format'
```

```vue
<TableCell>{{ formatDate(item.createTime) }}</TableCell>
```

**效果:** `2025-12-05T01:08:55.991Z` → `2025-12-05 01:08:55`

### 已应用页面
用户、角色、部门、岗位、字典、通知、参数配置等所有系统管理页面。

---

## 参考文档
- [Reka UI - Checkbox](https://reka-ui.com/docs/components/checkbox)
- [shadcn-vue - Switch](https://www.shadcn-vue.com/docs/components/switch)

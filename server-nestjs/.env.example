# ============================================================================
# Xunyin Admin - 后端环境变量配置文件
# ============================================================================
# 使用说明：
# 1. 复制此文件为 .env：cp .env.example .env
# 2. 根据实际环境修改配置值
# 3. 修改后需重启服务：npm run start:dev
# 4. 特殊字符需 URL 编码：@ => %40, : => %3A, / => %2F
# ============================================================================

# ==================== 应用配置 ====================
# 服务监听端口（前端代理和脚本会读取此值）
PORT=3000

# Node.js 运行环境：development | production
# development：彩色控制台输出，详细错误信息
# production：JSON 格式文件输出，精简错误信息
NODE_ENV=development

# 是否返回详细错误信息（生产环境建议设为 false）
ERROR_FULL=true

# ==================== 数据库配置 ====================
# PostgreSQL 连接字符串
# 格式：postgresql://用户名:密码@主机:端口/数据库名?schema=模式名
# 示例：postgresql://user:pass%401234@localhost:5432/db_name?schema=public
# 注意：密码中的特殊字符需 URL 编码（@ => %40）
# Docker 部署：宿主机端口映射为 5433，避免与本地 PostgreSQL 冲突
DATABASE_URL="postgresql://xunyin_admin:XunyinAdmin@2024@localhost:5432/xunyin_admin?schema=public"

# ==================== JWT 配置 ====================
# JWT 签名密钥（生产环境务必使用强随机字符串，长度建议 32 位以上）
# 生成方法：node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=super-secret-key-change-it

# JWT 过期时间由数据库配置 sys.session.timeout 控制（系统管理 > 参数设置）

# ==================== Redis 配置 ====================
# 是否启用真实 Redis 服务
# - true：连接真实 Redis 服务器（生产环境推荐）
# - false：使用内存模式，无需安装 Redis（开发环境推荐）
#
# 内存模式说明：
# - 优点：零配置，开箱即用，适合本地开发和测试
# - 缺点：重启后数据丢失，不支持多实例共享缓存
#
# 影响的模块：
# - 在线用户管理（monitor/online）：用户登录状态存储
# - 缓存监控（monitor/cache）：Redis 状态监控页面
#
# 生产环境建议：
# - 设置 REDIS_ENABLED=true 并配置 REDIS_URL
# - 多实例部署时必须使用真实 Redis 以共享会话和缓存
REDIS_ENABLED=false

# Redis 连接字符串（仅当 REDIS_ENABLED=true 时生效）
# 格式：redis://[用户名:密码@]主机:端口[/数据库索引]
# 无密码：redis://127.0.0.1:6379
# 有密码：redis://:yourPassword@127.0.0.1:6379/0
#
# 数据库索引说明：
# - 单机 Redis：支持 0-15（默认），由 redis.conf 的 databases 配置决定
# - Redis Cluster：仅支持 DB 0
# - 建议使用键前缀隔离，而非依赖多 DB 索引
#
# 键前缀示例：
# - 在线用户：online:*
# - JWT 黑名单：jwt:blacklist:*
# - 多租户：tenant:acme:online:*, tenant:acme:jwt:blacklist:*
# - 多环境：env:prod:online:*, env:stg:jwt:blacklist:*
REDIS_URL=redis://127.0.0.1:6379

# ==================== 日志配置 ====================
# 日志级别（从低到高）：error | warn | info | http | verbose | debug | silly
# 开发环境建议：debug 或 info
# 生产环境建议：info 或 warn
LOG_LEVEL=info

# 日志文件存储目录（相对路径或绝对路径）
# 相对路径：logs（相对于项目根目录）
# 绝对路径：/var/log/xunyin-admin
LOG_DIR=logs

# ==================== Git 配置 ====================
# GitHub 仓库地址（用于更新日志功能）
# 格式：https://github.com/owner/repo 或 owner/repo
# 示例：https://github.com/your-org/xunyin-admin
GIT_REPO=

# GitHub Personal Access Token（可选，用于提高 API 请求限制）
# 无 Token：60 次/小时
# 有 Token：5000 次/小时
# 生成方法：GitHub Settings > Developer settings > Personal access tokens
GIT_TOKEN=

# ==================== CORS 配置 ====================
# 允许的跨域来源
#
# 行为说明：
# - 开发环境 (NODE_ENV=development)：忽略此配置，允许所有来源
# - 生产环境 (NODE_ENV=production)：
#   - 已配置：只允许白名单中的来源访问
#   - 未配置：拒绝所有跨域请求（安全默认值）
#
# 格式：多个来源用逗号分隔，不要有多余空格
# 示例：https://admin.example.com,https://www.example.com
#
# 注意：生产环境部署前必须配置此项，否则前端将无法访问 API
CORS_ORIGINS=
